# Exim CVE-2024-39929 Exploit PoC

This repository contains a Proof-of-Concept (PoC) script to exploit the Exim vulnerability CVE-2024-39929. The vulnerability affects Exim versions up to and including 4.97.1, allowing attackers to bypass file extension blocking mechanisms and potentially deliver executable attachments to users' mailboxes.

## Description

The PoC script in this repository reads a list of SMTP servers from an external file and sends an email with a crafted attachment designed to exploit CVE-2024-39929. The script dynamically sets the email subject to indicate the server through which the email was passed.

## Usage

### Prerequisites

- Python 3.x
- `smtplib` and `email` modules (standard with Python)

### Installation

1. Clone the repository:
    ```sh
    git clone https://github.com/yourusername/exim-cve-2024-39929-poc.git
    cd exim-cve-2024-39929-poc
    ```

2. Ensure you have a file named `servers.txt` in the repository directory. This file should contain a list of IP addresses or FQDNs, each on a new line.

### Running the Script

1. Execute the script, providing the path to `servers.txt` as a command-line argument:
    ```sh
    python send_exploit_email.py path/to/servers.txt
    ```

2. The script will prompt you for the sender and recipient email addresses:
    ```plaintext
    Enter the sender email address: sample@test.com
    Enter the recipient email address: sample@test.com
    ```

### Example

```sh
python send_exploit_email.py servers.txt
```

Example prompts:
```plaintext
Enter the sender email address: sample@test.com
Enter the recipient email address: sample@test.com
```

## Script Details

The script performs the following actions:
1. Reads the list of SMTP servers from the specified file.
2. Prompts the user for sender and recipient email addresses.
3. Connects to each SMTP server on port 25.
4. Sends an email with a crafted attachment designed to exploit CVE-2024-39929.
5. Sets the email subject to indicate the server used for sending the email.
6. Prints debug information and handles exceptions.

## Important Considerations

- **Ethical Use**: Ensure you have permission to test these servers for vulnerabilities. Unauthorized testing can be illegal and unethical.
- **Monitoring**: Monitor the responses and behaviors of the servers to determine if the exploit was successful.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Disclaimer

This tool is intended for educational purposes and authorized testing only. The authors are not responsible for any misuse of this tool.

## Contact

For issues, questions, or contributions, please create an issue or submit a pull request on the [GitHub repository](https://github.com/yourusername/exim-cve-2024-39929-poc).
